-- Calculate total sales revenue
SELECT SUM(quantity_of_items_sold * unit_price * (1 - discount)) AS total_sales_revenue
FROM sales;

-- Calculate total quantity sold
SELECT SUM(quantity_of_items_sold) AS total_quantity_sold
FROM sales;

-- Calculate average unit price
SELECT AVG(unit_price) AS average_unit_price
FROM sales;

-- Calculate average discount rate
SELECT AVG(discount) AS average_discount_rate
FROM sales;

-- Calculate total discount amount
SELECT SUM(quantity_of_items_sold * unit_price * discount) AS total_discount_amount
FROM sales;

-- Count the number of transactions
SELECT COUNT(transaction_id) AS num_transactions
FROM sales;

-- Calculate sales by store
SELECT store_id, SUM(quantity_of_items_sold * unit_price * (1 - discount)) AS sales_by_store
FROM sales
GROUP BY store_id;

-- Calculate sales by product
SELECT product_id, SUM(quantity_of_items_sold * unit_price * (1 - discount)) AS sales_by_product
FROM sales
GROUP BY product_id;

-- Calculate sales by client
SELECT client_id, SUM(quantity_of_items_sold * unit_price * (1 - discount)) AS sales_by_client
FROM sales
GROUP BY client_id;

-- Calculate sales by address
SELECT address_id, SUM(quantity_of_items_sold * unit_price * (1 - discount)) AS sales_by_address
FROM sales
GROUP BY address_id;


-- most sell product for each store
WITH ProductSales AS (
    SELECT 
        store_id, 
        product_id, 
        SUM(quantity_of_items_sold) AS total_quantity_sold,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY SUM(quantity_of_items_sold) DESC) AS rn
    FROM sales
    GROUP BY store_id, product_id
)
SELECT
    store_id,
    product_id,
    total_quantity_sold
FROM ProductSales
WHERE rn = 1;